# AI 워크플로우 문서 구조 설명

## 🎯 목적

바이브코딩 환경에서 AI 에이전트가 **효율적으로 작업**할 수 있도록 문서를 구조화합니다.

---

## 🍔 맥도날드 시스템 개념

| 역할 | 비유 | 책임 |
|------|------|------|
| PM | 사장 | PRD 작성, 비전/우선순위 |
| 바이브코더 | 지점장 | Skill 문서 관리, 에이전트 지시, 품질 관리 |
| AI 에이전트 | 알바생 | 매뉴얼(200줄)만 읽고 빠르게 작업 수행 |

**핵심 인사이트**: AI는 많이 알수록 똑똑해지는 게 아님. 200줄 매뉴얼로 일하는 알바처럼 **적은 컨텍스트**로 **정확하게** 일해야 함.

---

## 📂 디렉터리 구조

```
프로젝트/
├── .agent/
│   └── workflows/
│       └── start.md              ← [1] 에이전트 초기화
│
└── docs/
    ├── prompts/
    │   ├── RULES.md              ← [2] 대원칙 (200줄 이내)
    │   │
    │   ├── guidelines/           ← [3] 기술 가이드 (각 200줄 권장)
    │   │   ├── frontend.md
    │   │   ├── backend.md
    │   │   ├── rebalancing.md
    │   │   └── ...
    │   │
    │   └── appendix/             ← [4] 상세 참조 (길이 제한 없음)
    │       ├── db-schema.md
    │       └── api-spec.md
    │
    ├── prd/                      ← [5] PRD 문서 (6단계 템플릿)
    │   └── feature-*.md
    │
    └── decisions/                ← [6] 결정 로그 (ADR)
        └── ADR-*.md
```

---

## 🔍 각 폴더의 역할과 설계 이유

### [1] `.agent/workflows/start.md`

**역할**: 에이전트 초기화 명령
**왜 필요한가?**

- Antigravity는 자동으로 RULES.md를 읽지 않음
- `/start` 명령어로 호출하면 RULES.md를 읽도록 지시
- 매번 `@RULES.md` 멘션 불필요

---

### [2] `docs/prompts/RULES.md` (대원칙)

**역할**: 모든 작업의 기준점, 네비게이션 허브
**왜 200줄 이내인가?**

- 컨텍스트 폭발 방지 (2,000줄 → 환각 증가)
- 에이전트가 빠르게 읽고 핵심만 파악
- 상세 내용은 guidelines/appendix로 분리

**포함 내용**:

- 핵심 원칙 4가지
- 문서 네비게이션 테이블 (어떤 작업 → 어떤 문서)
- 금지 사항
- 기술 스택 요약

---

### [3] `docs/prompts/guidelines/` (기술 가이드)

**역할**: 작업별 상세 가이드 (각 200줄 권장)
**왜 분리하는가?**

- 필요한 것만 선택적으로 로딩 → 토큰 절약
- 각 가이드가 독립적 → 유지보수 용이

**예시 파일**:

| 파일 | 내용 |
|------|------|
| `frontend.md` | React Native 컴포넌트 규칙, 스타일링 |
| `backend.md` | Spring Boot API 패턴, JPA 규칙 |
| `rebalancing.md` | 리밸런싱 계산 공식, 임계값 처리 ⭐ |
| `auth-flow.md` | JWT 토큰 흐름, 갱신 로직 |

---

### [4] `docs/prompts/appendix/` (상세 참조)

**역할**: 200줄 넘는 상세 정보 보관
**왜 분리하는가?**

- DB 스키마, API 전체 명세 등은 길어질 수밖에 없음
- 필요할 때만 참조 (항상 읽을 필요 없음)

**사용 시점**: guidelines에서 "상세는 appendix 참조" 언급 시

---

### [5] `docs/prd/` (PRD 문서)

**역할**: 기능별 요구사항 정의 (6단계 템플릿)
**왜 GitHub에 관리하는가?**

- 에이전트가 바로 참조 가능
- 코드와 요구사항이 같은 저장소에 → 동기화 용이
- "왜" 기록 강제 → 레거시 방지

**6단계 템플릿**:

1. Context (현재 상황)
2. Requirement (요구사항)
3. Design (설계)
4. Dependency (의존성)
5. Implementation (구현 계획)
6. Risk (리스크)

---

### [6] `docs/decisions/` (결정 로그 - ADR)

**역할**: 기술적 의사결정 기록
**왜 필요한가?**

- "왜 이 라이브러리를 썼지?" → 3개월 후 까먹음
- 결정 당시의 옵션들, 이유, 트레이드오프 기록
- 재검토 시점 명시 → 기술 부채 관리

**파일명 규칙**: `ADR-001-주제.md`

---

## 🔄 에이전트 작업 흐름

```
1. /start 명령 (또는 바이브코더 지시)
      ↓
2. RULES.md 읽기 (대원칙 + 네비게이션)
      ↓
3. 작업 유형 판단
      ↓
   ┌─────────────────────────────────────┐
   │ 필수 참조? → guidelines 해당 문서   │
   │ 권장 참조? → 복잡도 따라 판단       │
   │ 자율 진행? → 바로 작업              │
   └─────────────────────────────────────┘
      ↓
4. PRD 확인 (기능 구현 시)
      ↓
5. 작업 수행
      ↓
6. 테스트 및 품질 확인
```

---

## ✅ 기대 효과

| 효과 | 설명 |
|------|------|
| **토큰 절약** | 200줄 원칙 → 컨텍스트 폭발 방지 |
| **환각 감소** | 적은 정보, 명확한 규칙 → 정확도 향상 |
| **일관성** | 같은 규칙으로 작업 → 코드 품질 일정 |
| **온보딩** | 새 팀원/에이전트도 문서만 보고 작업 가능 |
| **레거시 방지** | PRD + ADR에 "왜" 기록 → 의도 보존 |

---

## 📝 다음 단계

1. 프로젝트에 위 구조로 폴더 생성
2. RULES.md, start.md 배치
3. 첫 번째 guidelines 문서 작성 (rebalancing.md 추천)
4. 기존 PRD를 6단계 템플릿으로 마이그레이션

---

*작성일: 2025-12-24*
