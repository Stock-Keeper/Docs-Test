# 1. 기술 명세 관련

### 1-1. 한국투자증권 API

- **API 문서 링크**: [한투증권 API 포털](https://apiportal.koreainvestment.com/apiservice)
- **사용 예정 API 목록**:
    - [ ]  국내주식시세 API (실시간 시세 조회)
    - [ ]  종목검색 API
    - [ ]  기타 필요 API: `필요시 추가`
- **API 호출 제한**:
    - 분당 요청 제한: `한투 API 문서 확인 후 작성 - 일반적으로 20~30회/분 수준`
    - 일일 요청 제한: `한투 API 문서 확인 후 작성`
- **인증 방식**:
    - App Key: `한투증권 개발자 센터에서 발급 필요 (현재 미발급 상태)`
    - App Secret: `한투증권 개발자 센터에서 발급 필요 (현재 미발급 상태)`
    - 토큰 발급 방식: `OAuth 2.0 기반 접근토큰 발급 방식`
- **제약사항 및 유의사항**:
    - 장 운영 시간: `평일 09:00-15:30 (한국 증시 거래시간) + 장외 데이터는 제한적`
    - 데이터 지연 시간: `API 문서에서 확인 필요 - 실시간 또는 분 단위 지연 가능성 있음`
    - 기타 제약: `무료 계정의 경우 호출 횟수 제한, 상용 API로 업그레이드 검토 필요`

### 1-2. Google OAuth 2.0 소셜 로그인

- **공식 문서**: [Google OAuth 2.0 가이드](https://developers.google.com/identity/protocols/oauth2?hl=ko)
- **클라이언트 설정**:
    - 클라이언트 ID: `Google Cloud Console에서 발급 필요 (프로젝트 생성 후 OAuth 2.0 클라이언트 ID 생성)`
    - 클라이언트 Secret: `Google Cloud Console에서 발급 필요`
    - Redirect URI: `개발: exp://[localhost:19000](http://localhost:19000) (Expo) / 프로덕션: yourapp://auth/callback 또는 [https://yourdomain.com/auth/google/callback](https://yourdomain.com/auth/google/callback)`
- **요청 권한 (Scope)**:
    - [ ]  email (이메일 주소)
    - [ ]  profile (프로필 정보 - 이름, 프로필 사진)
    - [ ]  openid (OpenID Connect - 필수)
    - 기타: `Phase 1에서는 위 3개로 충분, 추가 권한 필요시 팀 논의`
- **사용자 정보 처리**:
    - 수집 정보: `이메일(필수), 이름, 프로필 사진 URL, Google User ID`
    - 정보 저장 위치: `users 테이블 (컬럼: id, email, name, profile_image_url, google_id, created_at, updated_at)`

### 1-3. JWT 토큰 정책

- **Access Token**:
    - 유효기간: `1시간 (3600초) - 보안과 사용성 균형`
    - 저장 위치: `React Native Secure Storage 또는 AsyncStorage (모바일 환경에서는 HttpOnly Cookie 사용 불가)`
    - 페이로드 포함 정보: `user_id, email, name, role(user/admin), iat(발급시간), exp(만료시간)`
- **Refresh Token**:
    - 유효기간: `14일 (1209600초) - 사용자 편의성 고려`
    - 저장 위치: `React Native Secure Storage (암호화 저장) + DB에 해시값 저장 (토큰 무효화를 위해)`
    - 갱신 정책: `Access Token 만료 시 API 요청에서 401 에러 발생 → Refresh Token으로 자동 갱신`
- **보안 요구사항**:
    - [ ]  HTTPS 필수 적용 (프로덕션 환경, 개발은 [localhost](http://localhost) 허용)
    - [ ]  XSS 방어: `React Native는 기본 방어 / 입력값 검증 및 sanitization 적용`
    - [ ]  CSRF 방어: `모바일 앱은 CSRF 위험 낮음 / API에 토큰 기반 인증 사용시 자동 방어`
    - [ ]  토큰 암호화 알고리즘: `HS256 (HMAC-SHA256) - 초기 구현 간편, Secret Key는 환경변수로 관리`
- **토큰 갱신 로직**:
    - 자동 갱신 여부: `Yes - 사용자 경험 향상을 위해 필수`
    - 갱신 시점: `API 요청 시 401 Unauthorized 에러 발생 시 자동으로 Refresh Token 사용 갱신`
    - 갱신 실패 시 처리: `로그아웃 처리 후 로그인 화면으로 이동 + 토스트 메시지 표시`

### 1-4. 기술 스택

- **Frontend**:
    - 프레임워크: `React Native (Expo 또는 React Native CLI)`
    - 상태관리: `React Context API (Phase 1) → Zustand 또는 Redux Toolkit (Phase 2, 복잡도 증가 시)`
        - **상태관리란?** 여러 화면이 공유하는 데이터(로그인 정보, 포트폴리오 목록)를 관리하는 도구
    - 스타일링: `styled-components 또는 React Native StyleSheet + Flexbox`
- **Backend**:
    - 프레임워크: `Spring Boot 3.x (Java)`
    - 언어: `Java 17 이상 (LTS 버전)`
    - ORM: `Spring Data JPA (Hibernate)`
        - **ORM이란?** SQL 직접 작성 없이 Java 객체로 DB를 다루는 기술 (예: `userRepository.findByEmail(email)`)
- **Database**:
    - DBMS: `MySQL 8.0 이상 (AWS RDS 사용 예정)`
    - 캐시: `Phase 1에서는 미사용 / Phase 2에서 Redis 검토 (주식 시세 캐싱용)`
        - **캐시란?** 자주 조회하는 데이터를 메모리에 저장해 속도 향상 (예: 주식 시세)
- **인프라**:
    - 호스팅: `AWS (EC2 + RDS) 또는 Expo EAS Build (모바일 앱 배포)`
    - CI/CD: `GitHub Actions (Push 시 자동 테스트 및 배포)`
        - **CI/CD란?** 코드를 GitHub에 push하면 자동으로 테스트 → 빌드 → 배포까지 수행하는 시스템