---
type: ui
phase: P3
screen: 포트폴리오 백테스팅 화면
related:
    api:
        - specs/api/portfolio/backtest.md
    ui:
        - specs/ui/portfolio/detail.md
---

# 포트폴리오 백테스팅 화면 (Portfolio Backtest)

## 개요

과거 시장 데이터를 기반으로 시뮬레이션을 돌려 누적 수익률, MDD 등 성과 지표를 확인하는 화면.

## 레이아웃

```
┌─────────────────────────────────┐
│  ← 포트폴리오 백테스팅          │
├─────────────────────────────────┤
│  [ 설정 영역 ]                   │
│  기간: [2021.01 ▼] ~ [2025.12 ▼]│
│  리밸런싱: [분기 1회 ▼]          │
│  조건: [비중 20% 차이 발생 시 ▼]│
│  [ 백테스팅 실행 (🪙 5 소모) ]   │
│  벤치마크: [코스피 ▼]              │
│  - 최대 낙폭 (MDD): -15.4%       │
│  - Sharpe Ratio: 1.2             │
│                                 │
│  [ 누적 수익률 차트 📈 ]          │
│  (벤치마크 코스피/S&P500 비교)    │
│                                 │
│  [ 🔄 비교 분석 추가 (🪙 2 소모)] │
└─────────────────────────────────┘
```

## 컴포넌트

### 1. 설정 폼

| 요소          | 설명                                            |
| ------------- | ----------------------------------------------- |
| 기간 선택     | 시작월~종료월 드롭다운 (최소 1개월 ~ 최대 10년) |
| 리밸런싱 주기 | 월/분기/반기/연 드롭다운                        |
| 리밸런싱 조건 | 비중 차이 퍼센트 설정                           |

### 2. 실행 버튼

- 토큰 차감/멤버십 검증 확인 모달 트리거
- 잔여 토큰/한도 표시

### 3. 결과 카드

| 요소        | 설명                          |
| ----------- | ----------------------------- |
| 수익률 지표 | CAGR, MDD, Sharpe Ratio 등    |
| 수익률 차트 | 시계열 그래프 (벤치마크 비교) |

### 4. 벤치마크 선택

- 드롭다운 (코스피/S&P500/나스닥 등 사용자 직접 선택)

### 5. 비교 분석 버튼

- 기존 결과에 새로운 조건의 백테스트 결과를 덧붙여 렌더링 (토큰 2개 소모)

## 상호작용

| 액션           | 동작                                            |
| -------------- | ----------------------------------------------- |
| 실행 버튼 클릭 | 토큰/멤버십 확인 모달 → 차감 → 결과 렌더링      |
| 비교 분석 클릭 | 조건 변경 후 기존 그래프와 비교 (Layered Chart) |

## 상태

| 상태      | UI                              |
| --------- | ------------------------------- |
| 로딩      | 차트 스켈레톤 + 프로그레스 바   |
| 결과 없음 | 설정 폼만 표시                  |
| 에러      | 에러 메시지 + 재시도 버튼       |
| 토큰 부족 | "토큰이 부족합니다" + 충전 버튼 |

## 관련 스펙

- API: `../../api/portfolio/backtest.md`
- UI: `detail.md`
