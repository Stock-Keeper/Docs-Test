# Phase Control ê²€ì¦ ë° P2/P3 ë¦¬ëª¨íŠ¸ ì‘ì—… êµ¬í˜„ ê³„íš

> **ì‘ì„±ì¼**: 2026-01-31
> **ìƒíƒœ**: ê²€í†  ëŒ€ê¸°

## ëª©í‘œ

P1 êµ¬í˜„ ê²€ì¦, P2/P3 ê¸°ëŠ¥ ì½”ë“œ ëª…ì‹œ ë° í† ê¸€ ì‹œìŠ¤í…œ êµ¬ì¶•, notification/community í™”ë©´ êµ¬í˜„

---

## âš ï¸ ì¶©ëŒ ë°©ì§€ ì „ëµ

### í˜„ì¬ ë¦¬ëª¨ì½˜ ê¸°ëŠ¥ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Control Panel                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Phase Toggle    â”‚  í™”ë©´ í•„í„°ë§ (screens.json phase ê¸°ë°˜)   â”‚
â”‚  (P1/P2/P3)      â”‚  â†’ renderNavButtons() ì¬í˜¸ì¶œ             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Navigation      â”‚  í™”ë©´ ì „í™˜ (navigateTo)                  â”‚
â”‚  (ğŸ ğŸ“ŠğŸ”...)    â”‚  â†’ ì»¨íŠ¸ë¡¤ëŸ¬ cleanup/reset, ìƒíƒœë²„íŠ¼ ê°±ì‹   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  State Toggle    â”‚  í™”ë©´ë³„ ìƒíƒœ ë³€ê²½ (loading/error/empty)  â”‚
â”‚  (â³âŒğŸ“­...)    â”‚  â†’ CustomEvent ë°œì†¡                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  App Control     â”‚  ì•± ì‹œì‘/ì´ˆê¸°í™”                          â”‚
â”‚  (ğŸš€ğŸ”„)          â”‚  â†’ í™”ë©´ í”Œë¡œìš°, isFirstVisit ë¦¬ì…‹        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë¶„ë¦¬ ì›ì¹™ âœ…

| ë ˆì´ì–´ | ì œì–´ ëŒ€ìƒ | ë°©ì‹ |
|--------|-----------|------|
| Phase â†’ **í™”ë©´ ëª©ë¡** | ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ | `screens.json` phase + JS í•„í„° |
| Phase â†’ **ìš”ì†Œ í‘œì‹œ** | í™”ë©´ ë‚´ë¶€ P2/P3 ìš”ì†Œ | `data-phase` + CSS |
| Navigation | í™”ë©´ ì „í™˜ | ê¸°ì¡´ `navigateTo()` |
| State | í™”ë©´ ìƒíƒœ | ê¸°ì¡´ `toggleState()` + ì´ë²¤íŠ¸ |

### í•µì‹¬: Phase í† ê¸€ì€ ë‘ ê°€ì§€ ì—­í•  ìˆ˜í–‰

1. **í™”ë©´ í•„í„°ë§** (ê¸°ì¡´): `renderNavButtons()` - ë„¤ë¹„ê²Œì´ì…˜ì— í‘œì‹œí•  í™”ë©´ ê²°ì •
2. **ìš”ì†Œ í† ê¸€** (ì‹ ê·œ): `data-current-phase` - í™”ë©´ ë‚´ë¶€ P2/P3 ìš”ì†Œ í‘œì‹œ/ìˆ¨ê¹€

---

## êµ¬í˜„ ìƒì„¸

### 1. control-panel.js ìˆ˜ì •

```javascript
// setPhase() í•¨ìˆ˜ì— ì¶”ê°€
window.setPhase = function (phase) {
    currentPhase = phase;
    
    // âœ… ê¸°ì¡´: Phase ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
    document.querySelectorAll('.phase-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.phase === phase);
    });
    
    // âœ… ê¸°ì¡´: ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ì¬ë Œë”ë§
    renderNavButtons();
    
    // âœ… ê¸°ì¡´: ë„¤ë¹„ê²Œì´ì…˜ ë¦¬ìŠ¤ë„ˆ ì¬ë“±ë¡
    document.querySelectorAll('.nav-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            import('./navigation.js').then(nav => nav.navigateTo(btn.dataset.screen));
        });
    });
    
    // ğŸ†• ì‹ ê·œ: í™”ë©´ ë‚´ë¶€ ìš”ì†Œ í† ê¸€ìš© data ì†ì„±
    document.body.setAttribute('data-current-phase', phase);
};
```

### 2. ì´ˆê¸°í™” ì‹œì  ë™ê¸°í™”

```javascript
// initControlPanel() ë§ˆì§€ë§‰ì— ì¶”ê°€
document.body.setAttribute('data-current-phase', currentPhase);
```

### 3. CSS í† ê¸€ ê·œì¹™ (base.css)

```css
/* === Phase-based Element Toggle === */

/* P1 ëª¨ë“œ: P2/P3 ì „ìš© ìš”ì†Œ ìˆ¨ê¹€ */
body[data-current-phase="P1"] [data-phase="P2"],
body[data-current-phase="P1"] [data-phase="P3"] {
    display: none !important;
}

/* P2 ëª¨ë“œ: P3 ì „ìš© ìˆ¨ê¹€, P2 í”Œë ˆì´ìŠ¤í™€ë” ìˆ¨ê¹€ */
body[data-current-phase="P2"] [data-phase="P3"],
body[data-current-phase="P2"] [data-phase-placeholder="P2"] {
    display: none !important;
}

/* P3 ëª¨ë“œ: ëª¨ë“  í”Œë ˆì´ìŠ¤í™€ë” ìˆ¨ê¹€ */
body[data-current-phase="P3"] [data-phase-placeholder] {
    display: none !important;
}
```

### 4. HTML ë§ˆí‚¹ ì˜ˆì‹œ (stock/detail.html)

```html
<!-- P1ìš© í”Œë ˆì´ìŠ¤í™€ë” (P2ì—ì„œ ìˆ¨ê¹€) -->
<div class="chart-placeholder" data-phase-placeholder="P2">
    <span>ì¶”í›„ ì§€ì› ì˜ˆì •</span>
</div>

<!-- P2 ì‹¤ì œ ì°¨íŠ¸ (P1ì—ì„œ ìˆ¨ê¹€) -->
<section class="chart-section" data-phase="P2">
    <div class="candlestick-chart">...</div>
</section>
```

---

## ì¶©ëŒ ì‹œë‚˜ë¦¬ì˜¤ ë° í•´ê²°

| ì‹œë‚˜ë¦¬ì˜¤ | ë¬¸ì œ | í•´ê²° |
|----------|------|------|
| P2ì—ì„œ P1ë¡œ ì „í™˜ ì‹œ í˜„ì¬ í™”ë©´ì´ P2 ì „ìš© | ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ì‚¬ë¼ì§ | í™”ë©´ì€ ìœ ì§€, ìš”ì†Œë§Œ í† ê¸€ |
| ì•± ì´ˆê¸°í™” í›„ Phase ìƒíƒœ | Phase ìœ ì§€ë¨ | `resetApp()`ì—ì„œ Phase ë¦¬ì…‹ ë¶ˆí•„ìš” (ë³„ê°œ) |
| ìƒíƒœ í† ê¸€ + Phase í† ê¸€ ë™ì‹œ | ë…ë¦½ ë™ì‘ | ìƒíƒœëŠ” ì»¨íŠ¸ë¡¤ëŸ¬, PhaseëŠ” CSSë¡œ ë¶„ë¦¬ |

---

## ì‘ì—… ìˆœì„œ

1. [ ] `control-panel.js`: `setPhase()`ì— `data-current-phase` ì¶”ê°€
2. [ ] `control-panel.js`: `initControlPanel()`ì— ì´ˆê¸°ê°’ ì„¤ì •
3. [ ] `base.css`: Phase í† ê¸€ CSS ê·œì¹™ ì¶”ê°€
4. [ ] `stock/detail.html`: ì°¨íŠ¸ ì˜ì—­ ë§ˆí‚¹ í…ŒìŠ¤íŠ¸
5. [ ] ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸: P1â†”P2 ì „í™˜ ì‹œ ìš”ì†Œ í‘œì‹œ/ìˆ¨ê¹€ í™•ì¸

---

## ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] P1â†’P2 ì „í™˜: ì°¨íŠ¸ í”Œë ˆì´ìŠ¤í™€ë” ìˆ¨ê¹€, ì‹¤ì œ ì°¨íŠ¸ í‘œì‹œ
- [ ] P2â†’P1 ì „í™˜: ì°¨íŠ¸ ìˆ¨ê¹€, í”Œë ˆì´ìŠ¤í™€ë” í‘œì‹œ
- [ ] í™”ë©´ ì „í™˜ ì •ìƒ ì‘ë™ í™•ì¸
- [ ] ìƒíƒœ í† ê¸€ ì •ìƒ ì‘ë™ í™•ì¸
- [ ] ì•± ì‹œì‘/ì´ˆê¸°í™” ì •ìƒ ì‘ë™ í™•ì¸
